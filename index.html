<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ã‚¹ãƒ­ãƒƒãƒˆã‚²ãƒ¼ãƒ </title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link
		href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=M+PLUS+Rounded+1c:wght@700&display=swap"
		rel="stylesheet">
	<style>
		body {
			font-family: 'Inter', 'M PLUS Rounded 1c', sans-serif;
		}

		.slot-container {
			background: linear-gradient(145deg, #2a2a2a, #1e1e1e);
			box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3), inset 0 0 15px rgba(0, 0, 0, 0.5);
			border: 5px solid #444;
			border-top-color: #555;
			border-bottom-color: #333;
		}

		.reel {
			width: 100px;
			height: 120px;
			background-color: #1a1a1a;
			border: 3px solid #555;
			overflow: hidden;
			position: relative;
			box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
		}

		.reel-inner {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			/* JavaScriptã§å‹•çš„ã«ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¾ã™ */
		}

		.symbol {
			width: 100%;
			height: 120px;
			display: flex;
			justify-content: center;
			align-items: center;
			font-size: 60px;
		}

		.spin-button {
			transition: all 0.2s ease-in-out;
			box-shadow: 0 5px 0 #c0392b;
		}

		.spin-button:active {
			transform: translateY(5px);
			box-shadow: 0 0 0 #c0392b;
		}

		.spin-button:disabled {
			background-color: #95a5a6;
			cursor: not-allowed;
			box-shadow: 0 5px 0 #7f8c8d;
		}

		.message-box {
			transition: all 0.3s ease-in-out;
		}

		.highlight {
			animation: highlight-animation 1s ease-in-out;
		}

		@keyframes highlight-animation {

			0%,
			100% {
				transform: scale(1);
				box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
			}

			50% {
				transform: scale(1.05);
				box-shadow: 0 0 25px 10px #f1c40f;
			}
		}
	</style>
</head>

<body class="bg-gray-800 text-white flex items-center justify-center min-h-screen p-4">

	<div class="w-full max-w-md mx-auto">
		<h1 class="text-4xl font-bold text-center mb-2 text-yellow-400"
			style="font-family: 'M PLUS Rounded 1c', sans-serif;">ã‚¹ãƒ­ãƒƒãƒˆã‚²ãƒ¼ãƒ </h1>
		<div class="flex justify-between items-center bg-gray-900 px-4 py-2 rounded-t-lg">
			<div class="text-lg">
				<span>ã‚³ã‚¤ãƒ³: </span>
				<span id="coin-display" class="font-bold text-yellow-400">100</span>
			</div>
			<div class="text-lg">
				<span>ãƒ™ãƒƒãƒˆ: </span>
				<span class="font-bold text-cyan-400">10</span>
			</div>
		</div>

		<!-- ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³ã®æœ¬ä½“ -->
		<div class="slot-container rounded-b-lg p-6 md:p-8">
			<!-- ãƒªãƒ¼ãƒ«éƒ¨åˆ† -->
			<div class="flex justify-center space-x-4 mb-6">
				<div id="reel1" class="reel rounded-lg">
					<div class="reel-inner"></div>
				</div>
				<div id="reel2" class="reel rounded-lg">
					<div class="reel-inner"></div>
				</div>
				<div id="reel3" class="reel rounded-lg">
					<div class="reel-inner"></div>
				</div>
			</div>

			<!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
			<div id="message-box"
				class="message-box text-center h-10 flex items-center justify-center text-xl font-bold mb-6 rounded-lg bg-gray-700/50">
				ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­ï¼
			</div>

			<!-- æ“ä½œãƒœã‚¿ãƒ³ -->
			<div class="flex justify-center">
				<button id="spin-button"
					class="spin-button w-full max-w-xs bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-4 rounded-lg text-2xl">
					ã‚¹ãƒ”ãƒ³ï¼
				</button>
			</div>
		</div>
	</div>

	<script>
		// DOMè¦ç´ ã®å–å¾—
		const coinDisplay = document.getElementById('coin-display');
		const spinButton = document.getElementById('spin-button');
		const messageBox = document.getElementById('message-box');
		const reels = [
			document.querySelector('#reel1 .reel-inner'),
			document.querySelector('#reel2 .reel-inner'),
			document.querySelector('#reel3 .reel-inner')
		];

		// ã‚²ãƒ¼ãƒ ã®è¨­å®š
		const symbols = ['ğŸ’', 'ğŸ‹', 'ğŸŠ', 'ğŸ‰', 'ğŸ””', 'â­', 'ï¼—'];
		const payouts = {
			'ğŸ’': 20,
			'ğŸ‹': 30,
			'ğŸŠ': 40,
			'ğŸ‰': 50,
			'ğŸ””': 100,
			'â­': 200,
			'ï¼—': 500
		};
		const betAmount = 10;
		const symbolHeight = 120; // .symbolã®é«˜ã•ã¨ä¸€è‡´ã•ã›ã‚‹
		const blurSymbolsCount = 20; // å›è»¢ä¸­ã«è¡¨ç¤ºã™ã‚‹ã‚·ãƒ³ãƒœãƒ«ã®æ•°

		// ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹
		let coins = 100;
		let isSpinning = false;

		// åˆæœŸåŒ–å‡¦ç†
		function init() {
			updateCoinDisplay();
			reels.forEach(reel => {
				reel.innerHTML = ''; // ä¸­èº«ã‚’ã‚¯ãƒªã‚¢
				reel.appendChild(createSymbolElement(getRandomSymbol()));
			});
		}

		// ã‚³ã‚¤ãƒ³è¡¨ç¤ºã‚’æ›´æ–°
		function updateCoinDisplay() {
			coinDisplay.textContent = coins;
		}

		// ãƒ©ãƒ³ãƒ€ãƒ ãªã‚·ãƒ³ãƒœãƒ«ã‚’å–å¾—
		function getRandomSymbol() {
			return symbols[Math.floor(Math.random() * symbols.length)];
		}

		// ã‚·ãƒ³ãƒœãƒ«ã‚’è¡¨ç¤ºã™ã‚‹DOMè¦ç´ ã‚’ä½œæˆ
		function createSymbolElement(symbol) {
			const div = document.createElement('div');
			div.className = 'symbol';
			div.textContent = symbol;
			return div;
		}

		// ã‚¹ãƒ”ãƒ³å‡¦ç†
		function spin() {
			if (isSpinning) return;
			if (coins < betAmount) {
				updateMessage("ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šã¾ã›ã‚“ï¼", "text-red-500");
				return;
			}

			isSpinning = true;
			spinButton.disabled = true;
			spinButton.textContent = 'ã‚¹ãƒ”ãƒ³ä¸­...';

			coins -= betAmount;
			updateCoinDisplay();
			updateMessage(" ", "text-white"); // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ

			const finalResults = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];
			const longestDuration = (2 + (reels.length - 1) * 0.5) * 1000;

			reels.forEach((reel, i) => {
				// 1. å›è»¢ç”¨ã®ã‚·ãƒ³ãƒœãƒ«ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚’ä½œæˆï¼ˆçµæœãŒä¸€ç•ªä¸Šã€ãƒ€ãƒŸãƒ¼ãŒãã®ä¸‹ï¼‰
				reel.innerHTML = '';
				// æœ€çµ‚çš„ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚·ãƒ³ãƒœãƒ«ã‚’ä¸€ç•ªä¸Šã«è¿½åŠ 
				reel.appendChild(createSymbolElement(finalResults[i]));
				// å›è»¢ä¸­ã«é€šã‚Šéãã‚‹ãƒ€ãƒŸãƒ¼ã‚·ãƒ³ãƒœãƒ«ã‚’ãã®ä¸‹ã«è¿½åŠ 
				for (let j = 0; j < blurSymbolsCount; j++) {
					reel.appendChild(createSymbolElement(getRandomSymbol()));
				}

				// 2. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ä½ç½®ï¼ˆä¸€ç•ªä¸‹ã®ãƒ€ãƒŸãƒ¼ã‚·ãƒ³ãƒœãƒ«ãŒè¦‹ãˆã‚‹ä½ç½®ï¼‰ã«è¨­å®š
				reel.style.transition = 'none';
				const initialPosition = -(blurSymbolsCount * symbolHeight);
				reel.style.top = `${initialPosition}px`;

				// ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒªã‚»ãƒƒãƒˆã‚’å¼·åˆ¶çš„ã«é©ç”¨ã•ã›ã‚‹
				reel.offsetHeight;

				// 3. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ï¼‰ã‚’è¨­å®š
				const spinDuration = 2 + i * 0.5; // ãƒªãƒ¼ãƒ«ã”ã¨ã«åœæ­¢ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ãšã‚‰ã™
				reel.style.transition = `top ${spinDuration}s cubic-bezier(0.25, 0.1, 0.25, 1)`; // ã‚¤ãƒ¼ã‚ºã‚¢ã‚¦ãƒˆï¼ˆã ã‚“ã ã‚“é…ããªã‚‹ï¼‰

				// 4. æœ€çµ‚çš„ãªåœæ­¢ä½ç½®ï¼ˆtop: 0ã€ä¸€ç•ªä¸Šã®ã‚·ãƒ³ãƒœãƒ«ãŒè¦‹ãˆã‚‹ä½ç½®ï¼‰ã‚’è¨­å®šã—ã¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹
				reel.style.top = '0px';
			});

			// å…¨ã¦ã®ãƒªãƒ¼ãƒ«ãŒåœæ­¢ã—ãŸå¾Œã«çµæœã‚’åˆ¤å®š
			setTimeout(() => {
				checkResult(finalResults);
			}, longestDuration);
		}

		// çµæœã‚’åˆ¤å®š
		function checkResult(results) {
			const [r1, r2, r3] = results;
			const parentReels = reels.map(r => r.parentElement);

			parentReels.forEach(pr => pr.classList.remove('highlight'));

			if (r1 === r2 && r2 === r3) {
				const payout = payouts[r1];
				coins += payout;
				updateMessage(`å¤§å½“ãŸã‚Šï¼ ${payout}ã‚³ã‚¤ãƒ³ç²å¾—ï¼`, "text-yellow-400");
				parentReels.forEach(pr => pr.classList.add('highlight'));
			} else {
				updateMessage("æ®‹å¿µã€ã¯ãšã‚Œ...", "text-gray-400");
			}

			updateCoinDisplay();
			isSpinning = false;
			spinButton.disabled = false;
			spinButton.textContent = 'ã‚¹ãƒ”ãƒ³ï¼';

			if (coins < betAmount) {
				updateMessage("ã‚³ã‚¤ãƒ³ãŒãªããªã‚Šã¾ã—ãŸ...", "text-red-500");
				spinButton.disabled = true;
			}

			// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã«ä¸è¦ãªè¦ç´ ã‚’å‰Šé™¤ã—ã¦DOMã‚’è»½ãã™ã‚‹
			reels.forEach((reel, i) => {
				reel.style.transition = 'none';
				const finalSymbol = results[i];
				reel.innerHTML = ''; // ä¸­èº«ã‚’ã‚¯ãƒªã‚¢
				reel.appendChild(createSymbolElement(finalSymbol));
				reel.style.top = '0';
			});
		}

		// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
		function updateMessage(text, colorClass) {
			messageBox.textContent = text;
			messageBox.className = `message-box text-center h-10 flex items-center justify-center text-xl font-bold mb-6 rounded-lg bg-gray-700/50 ${colorClass}`;
		}

		// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
		spinButton.addEventListener('click', spin);

		// ã‚²ãƒ¼ãƒ é–‹å§‹
		init();
	</script>
</body>

</html>