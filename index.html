<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éï„É´„Éº„ÉÑ„Çπ„É≠„ÉÉ„Éà„Ç≤„Éº„É†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Mochiy Pop One', sans-serif;
            background-color: #f0f9ff; /* tailwind: bg-sky-50 */
        }
        .slot-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            width: 300px;
            height: 300px;
            padding: 10px;
            background-color: #7dd3fc; /* tailwind: bg-sky-300 */
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1), inset 0 0 15px rgba(255,255,255,0.5);
        }
        .slot-cell {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.75rem; /* 44px */
            background-color: #f0f9ff; /* tailwind: bg-sky-50 */
            border-radius: 15px;
            box-shadow: inset 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .spinning {
            animation: spin-anim 0.1s linear infinite;
        }
        @keyframes spin-anim {
            0% { transform: translateY(-5px); }
            50% { transform: translateY(5px); }
            100% { transform: translateY(-5px); }
        }
        .win-line {
            background-color: #fef08a; /* tailwind: bg-yellow-200 */
            transform: scale(1.1);
            box-shadow: 0 0 20px #facc15; /* tailwind: shadow-yellow-400 */
        }
        .spin-button {
            transition: all 0.2s ease;
            box-shadow: 0 5px 0 #1e40af; /* tailwind: shadow-blue-800 */
        }
        .spin-button:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #1e40af; /* tailwind: shadow-blue-800 */
        }
        .spin-button:disabled {
            background-color: #9ca3af; /* tailwind: bg-gray-400 */
            box-shadow: 0 5px 0 #4b5563; /* tailwind: shadow-gray-600 */
            cursor: not-allowed;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div id="game-container" class="w-full max-w-md p-6 bg-white rounded-3xl shadow-2xl border-4 border-blue-300">
        <h1 class="text-4xl text-center font-bold text-blue-600 mb-2 tracking-wider">„Éï„É´„Éº„ÉÑ„Éù„ÉÉ„ÉóÔºÅ</h1>
        <p class="text-center text-gray-500 mb-6">üíé„ÅØ„ÉØ„Ç§„É´„Éâ„ÄÅ‚≠ê3„Å§„Åß„Éú„Éº„Éä„ÇπÔºÅ</p>

        <!-- „Çπ„Ç≥„Ç¢„Å®„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫ -->
        <div class="flex justify-between items-center mb-6 p-4 bg-blue-100 rounded-xl">
            <div>
                <span class="text-lg text-blue-800">„Çπ„Ç≥„Ç¢</span>
                <p id="score" class="text-3xl font-bold text-blue-600">1000</p>
            </div>
            <div class="text-right">
                <span class="text-lg text-blue-800">„Éô„ÉÉ„Éà</span>
                <p id="bet" class="text-3xl font-bold text-blue-600">10</p>
            </div>
        </div>
        
        <div id="message-box" class="h-10 text-center text-xl font-bold text-pink-500 mb-4 flex items-center justify-center"></div>

        <!-- „Çπ„É≠„ÉÉ„Éà„Éû„Ç∑„É≥Êú¨‰Ωì -->
        <div class="mx-auto slot-container mb-8">
            <!-- 3x3„ÅÆ„Çª„É´„ÅåJavaScript„Å´„Çà„Å£„Å¶„Åì„Åì„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
        </div>

        <!-- Êìç‰Ωú„Éú„Çø„É≥ -->
        <button id="spin-button" class="w-full py-4 text-2xl font-bold text-white bg-blue-500 rounded-xl spin-button hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300">
            „Çπ„Éî„É≥ÔºÅ
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- „Ç≤„Éº„É†Ë®≠ÂÆö ---
            const symbols = ['üçí', 'üçã', 'üçä', 'üçá', 'üçâ', 'üçì', 'üíé', '‚≠ê'];
            const symbolWeights = [15, 15, 15, 10, 10, 10, 5, 3]; // ÂêÑÁµµÊüÑ„ÅÆÂá∫„ÇÑ„Åô„ÅïÔºàÂêàË®à100Ôºâ
            const weightedSymbols = [];
            symbols.forEach((symbol, index) => {
                for (let i = 0; i < symbolWeights[index]; i++) {
                    weightedSymbols.push(symbol);
                }
            });

            const WILD_SYMBOL = 'üíé';
            const BONUS_SYMBOL = '‚≠ê';
            const INITIAL_SCORE = 1000;
            const SPIN_COST = 10;
            const SPIN_DURATION = 1500; // „Çπ„Éî„É≥„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅÆÊôÇÈñì (ms)
            const REEL_STOP_DELAY = 200; // ÂêÑ„É™„Éº„É´„ÅåÂÅúÊ≠¢„Åô„ÇãÊôÇÈñìÂ∑Æ (ms)

            // ÂêÑÁµµÊüÑ„ÅÆÊèÉ„Å£„ÅüÊôÇ„ÅÆ„Çπ„Ç≥„Ç¢
            const payoutTable = {
                'üçí': 20, 'üçã': 20, 'üçä': 20,
                'üçá': 50, 'üçâ': 50, 'üçì': 50,
                'üíé': 200, // „ÉØ„Ç§„É´„ÉâÁµµÊüÑ„ÅÆ„Åø„ÅßÊèÉ„Å£„ÅüÂ†¥Âêà
                '‚≠ê': 100  // „Éú„Éº„Éä„ÇπÁµµÊüÑ3„Å§„Åß„ÅÆ„Éú„Éº„Éä„Çπ
            };

            // ÂãùÂà©„É©„Ç§„É≥„ÅÆÂÆöÁæ© („Çª„É´„ÅÆ„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ 0-8)
            const winLines = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // Ê®™
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // Á∏¶
                [0, 4, 8], [2, 4, 6]  // Êñú„ÇÅ
            ];

            // --- DOMË¶ÅÁ¥† ---
            const slotContainer = document.querySelector('.slot-container');
            const spinButton = document.getElementById('spin-button');
            const scoreDisplay = document.getElementById('score');
            const messageBox = document.getElementById('message-box');
            
            let cells = [];
            let score = INITIAL_SCORE;
            let isSpinning = false;

            // --- ÂàùÊúüÂåñÂá¶ÁêÜ ---
            function init() {
                // 3x3„ÅÆ„Çª„É´„ÇíÁîüÊàê
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('slot-cell');
                    cell.dataset.index = i;
                    slotContainer.appendChild(cell);
                    cells.push(cell);
                }
                updateScore(0);
                spinButton.addEventListener('click', handleSpin);
            }

            // --- „Çπ„Éî„É≥Âá¶ÁêÜ ---
            function handleSpin() {
                if (isSpinning || score < SPIN_COST) return;

                isSpinning = true;
                spinButton.disabled = true;
                messageBox.textContent = '';
                cells.forEach(cell => cell.classList.remove('win-line'));

                updateScore(-SPIN_COST);

                const finalSymbols = Array(9).fill(null).map(() => getRandomSymbol());
                
                // „Çπ„Éî„É≥„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                cells.forEach((cell, index) => {
                    const reelIndex = index % 3;
                    cell.classList.add('spinning');
                    const spinInterval = setInterval(() => {
                        cell.textContent = getRandomSymbol();
                    }, 100);

                    setTimeout(() => {
                        clearInterval(spinInterval);
                        cell.classList.remove('spinning');
                        cell.textContent = finalSymbols[index];
                        
                        // ÂÖ®„Å¶„ÅÆ„É™„Éº„É´„ÅåÂÅúÊ≠¢„Åó„Åü„ÇâÁµêÊûú„Çí„ÉÅ„Çß„ÉÉ„ÇØ
                        if (index === 8) {
                            checkWin(finalSymbols);
                        }
                    }, SPIN_DURATION + reelIndex * REEL_STOP_DELAY);
                });
            }

            // --- ÂãùÂà©Âà§ÂÆö ---
            function checkWin(finalSymbols) {
                let totalWin = 0;
                let winningLinesFound = [];

                // 1. „Éú„Éº„Éä„Çπ„Ç∑„É≥„Éú„É´Ôºà„Çπ„Ç≠„É£„ÉÉ„Çø„ÉºÔºâ„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
                const bonusCount = finalSymbols.filter(s => s === BONUS_SYMBOL).length;
                if (bonusCount >= 3) {
                    const bonusWin = payoutTable[BONUS_SYMBOL] * bonusCount;
                    totalWin += bonusWin;
                    messageBox.textContent = `‚≠ê„Éú„Éº„Éä„ÇπÔºÅ +${bonusWin}`;
                    // „Éú„Éº„Éä„Çπ„Ç∑„É≥„Éú„É´„Çí„Éè„Ç§„É©„Ç§„Éà
                    finalSymbols.forEach((symbol, index) => {
                        if (symbol === BONUS_SYMBOL) {
                            winningLinesFound.push(index);
                        }
                    });
                }

                // 2. ÈÄöÂ∏∏„ÅÆ„Éö„Ç§„É©„Ç§„É≥„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
                winLines.forEach(line => {
                    const lineSymbols = line.map(index => finalSymbols[index]);
                    const firstSymbol = lineSymbols[0];
                    const secondSymbol = lineSymbols[1];
                    const thirdSymbol = lineSymbols[2];

                    let winSymbol = null;
                    
                    // „ÉØ„Ç§„É´„Éâ„ÇíËÄÉÊÖÆ„Åó„ÅüÂà§ÂÆö
                    const symbolsOnLine = lineSymbols.filter(s => s !== WILD_SYMBOL);
                    
                    if (symbolsOnLine.length <= 1) { // ÂÖ®„Å¶„ÉØ„Ç§„É´„Éâ„ÄÅ„Åæ„Åü„ÅØ2„Å§„ÉØ„Ç§„É´„ÉâÔºã1ÁµµÊüÑ
                        winSymbol = symbolsOnLine[0] || WILD_SYMBOL; // ÂÖ®„Å¶„ÉØ„Ç§„É´„Éâ„ÅÆÂ†¥Âêà„ÅØ„ÉØ„Ç§„É´„Éâ„ÅåÂãù„Å°ÁµµÊüÑ
                    } else if (symbolsOnLine.every(s => s === symbolsOnLine[0])) { // „ÉØ„Ç§„É´„Éâ‰ª•Â§ñ„ÅÆÁµµÊüÑ„ÅåÂÖ®„Å¶Âêå„Åò
                        winSymbol = symbolsOnLine[0];
                    }

                    if (winSymbol) {
                        const winAmount = payoutTable[winSymbol];
                        totalWin += winAmount;
                        line.forEach(index => winningLinesFound.push(index));
                    }
                });

                if (totalWin > 0) {
                    updateScore(totalWin);
                    if (!messageBox.textContent) { // „Éú„Éº„Éä„Çπ„É°„ÉÉ„Çª„Éº„Ç∏„Åå„Å™„Åë„Çå„Å∞
                        messageBox.textContent = `„Éí„ÉÉ„ÉàÔºÅ +${totalWin}`;
                    }
                    // ÈáçË§á„ÇíÈô§„ÅÑ„Å¶„Éè„Ç§„É©„Ç§„Éà
                    [...new Set(winningLinesFound)].forEach(index => {
                        cells[index].classList.add('win-line');
                    });
                } else {
                     messageBox.textContent = '';
                }

                isSpinning = false;
                spinButton.disabled = false;
                
                if (score < SPIN_COST) {
                    messageBox.textContent = "„Çπ„Ç≥„Ç¢„ÅåË∂≥„Çä„Åæ„Åõ„ÇìÔºÅ";
                    spinButton.disabled = true;
                }
            }

            // --- „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£Èñ¢Êï∞ ---
            function getRandomSymbol() {
                return weightedSymbols[Math.floor(Math.random() * weightedSymbols.length)];
            }

            function updateScore(amount) {
                score += amount;
                scoreDisplay.textContent = score;
            }

            // --- „Ç≤„Éº„É†ÈñãÂßã ---
            init();
        });
    </script>
</body>
</html>
