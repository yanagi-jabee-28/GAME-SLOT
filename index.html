<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>çµµæ–‡å­—ã‚¹ãƒ­ãƒƒãƒˆã‚²ãƒ¼ãƒ </title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700;900&display=swap" rel="stylesheet">
	<style>
		/* å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
		body {
			font-family: 'M PLUS Rounded 1c', sans-serif;
			background-color: #1a2a3a;
			color: #ffffff;
			display: flex;
			justify-content: center;
			align-items: center;
			min-height: 100vh;
			margin: 0;
			user-select: none;
		}

		/* ã‚²ãƒ¼ãƒ å…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ */
		#game-container {
			background: linear-gradient(45deg, #3a4a5a, #2a3a4a);
			border-radius: 20px;
			padding: 20px 30px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4), inset 0 2px 5px rgba(255, 255, 255, 0.1);
			border: 2px solid #5a6a7a;
			text-align: center;
			width: 90%;
			max-width: 400px;
		}

		/* ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ† */
		header h1 {
			font-size: 2.5rem;
			font-weight: 900;
			color: #ffc107;
			text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
			margin: 0 0 10px 0;
		}

		/* ã‚³ã‚¤ãƒ³è¡¨ç¤º */
		#credits-display {
			background-color: #111;
			color: #00ff00;
			font-size: 1.5rem;
			padding: 10px;
			border-radius: 10px;
			margin-bottom: 20px;
			border: 2px solid #444;
			box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
		}

		/* ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³æœ¬ä½“ */
		#slot-machine {
			display: flex;
			justify-content: center;
			gap: 10px;
			background-color: #000;
			padding: 15px;
			border-radius: 15px;
			border: 5px solid #888;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
			margin-bottom: 20px;
		}

		/* å„ãƒªãƒ¼ãƒ« */
		.reel {
			background-color: #fff;
			border: 2px solid #333;
			border-radius: 10px;
			overflow: hidden;
			width: 80px;
			height: 240px;
			/* 80px * 3ã‚»ãƒ«åˆ† */
			position: relative;
		}

		.reel-inner {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
		}

		/* å„ãƒã‚¹ */
		.cell {
			width: 80px;
			height: 80px;
			font-size: 50px;
			display: flex;
			justify-content: center;
			align-items: center;
			background-color: #fff;
			color: #333;
			border-bottom: 1px solid #ccc;
		}

		.cell:last-child {
			border-bottom: none;
		}

		/* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
		#result-display {
			height: 50px;
			font-size: 1.2rem;
			font-weight: bold;
			color: #ffeb3b;
			display: flex;
			justify-content: center;
			align-items: center;
			transition: all 0.3s ease;
		}

		/* ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ */
		#spin-button {
			background: linear-gradient(180deg, #f44336, #d32f2f);
			color: white;
			font-size: 1.8rem;
			font-weight: 700;
			padding: 15px 40px;
			border: none;
			border-radius: 50px;
			cursor: pointer;
			box-shadow: 0 5px 0 #9a0007, 0 8px 15px rgba(0, 0, 0, 0.4);
			transition: all 0.1s ease-in-out;
		}

		#spin-button:disabled {
			background: #777;
			box-shadow: 0 5px 0 #444;
			cursor: not-allowed;
		}

		#spin-button:not(:disabled):active {
			transform: translateY(5px);
			box-shadow: 0 0px 0 #9a0007;
		}

		/* ã‚¹ãƒ”ãƒ³ä¸­ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
		.spinning .reel-inner {
			animation: scroll-reel 0.2s linear infinite;
		}

		@keyframes scroll-reel {
			from {
				transform: translateY(-50%);
			}

			to {
				transform: translateY(0);
			}
		}

		/* å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
		.winning-cell {
			animation: win-pulse 0.8s infinite;
		}

		@keyframes win-pulse {
			0% {
				transform: scale(1);
				background-color: #fff2ab;
			}

			50% {
				transform: scale(1.1);
				background-color: #ffc107;
			}

			100% {
				transform: scale(1);
				background-color: #fff2ab;
			}
		}
	</style>
</head>

<body>

	<div id="game-container">
		<header>
			<h1>çµµæ–‡å­—ã‚¹ãƒ­ãƒƒãƒˆ</h1>
			<div id="credits-display">ã‚³ã‚¤ãƒ³: 1000</div>
		</header>

		<main>
			<div id="slot-machine">
				<div class="reel" id="reel1"></div>
				<div class="reel" id="reel2"></div>
				<div class="reel" id="reel3"></div>
			</div>

			<div id="result-display">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆï¼</div>
			<button id="spin-button">ã‚¹ãƒ”ãƒ³ï¼</button>
		</main>
	</div>

	<script>
		// --- DOMè¦ç´ ã®å–å¾— ---
		// HTMLã‹ã‚‰æ“ä½œã—ãŸã„è¦ç´ ã‚’å–å¾—ã—ã€å®šæ•°ã«æ ¼ç´ã—ã¦ãŠã
		const reelElements = [
			document.getElementById('reel1'),
			document.getElementById('reel2'),
			document.getElementById('reel3')
		];
		const spinButton = document.getElementById('spin-button');
		const creditsDisplay = document.getElementById('credits-display');
		const resultDisplay = document.getElementById('result-display');

		// --- ã‚²ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š ---

		// å„ãƒªãƒ¼ãƒ«ã®çµµæŸ„ã®ä¸¦ã³é †ï¼ˆãƒªãƒ¼ãƒ«ã‚¹ãƒˆãƒªãƒƒãƒ—ï¼‰
		// ãƒ–ãƒ©ãƒ³ã‚¯çµµæŸ„ã‚’ãªãã—ã€å½“ãŸã‚ŠãŒå‡ºã‚„ã™ã„ã‚ˆã†ã«èª¿æ•´ã€‚
		// ã¾ãŸã€ãƒªãƒ¼ãƒ«ã®ä¸¦ã³ã¯ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã›ãšã€å½“ãŸã‚ŠãŒå‡ºã‚„ã™ã„ã‚ˆã†ã«ã—ã¤ã¤ã‚‚ã€
		// é«˜é…å½“ã®çµµæŸ„ãŒé€£ç¶šã—ãªã„ã‚ˆã†ã«æ‰‹å‹•ã§æœ€é©ãªä¸¦ã³é †ã«èª¿æ•´ã—ã¦ã„ã‚‹ã€‚
		const reel1 = [
			'ğŸ’', 'ğŸ‰', 'ğŸ””', 'BAR', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'BAR', 'ğŸ‰', 'ğŸ’', 'ï¼—', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'BAR', 'ğŸ‘‘', 'ğŸ””', 'ğŸ’', 'ğŸ‰'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reel2 = [
			'BAR', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'BAR', 'ğŸ””', 'ğŸ’', 'ï¼—', 'ğŸ‰', 'ğŸ’', 'ğŸ””', 'BAR', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ğŸ‰'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reel3 = [
			'ğŸ‘‘', 'BAR', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ï¼—', 'ğŸ‰', 'BAR', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'ğŸ‘‘', 'ğŸ””', 'ğŸ’', 'BAR', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'ğŸ’'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reels = [reel1, reel2, reel3]; // 3æœ¬ã®ãƒªãƒ¼ãƒ«ã‚’é…åˆ—ã«ã¾ã¨ã‚ã‚‹

		// é…å½“è¡¨ (ã‚­ãƒ¼ã¯æƒã£ãŸçµµæŸ„ã‚’é€£çµã—ãŸæ–‡å­—åˆ—)
		// ã©ã®çµµæŸ„ãŒ3ã¤æƒã†ã¨ã€ä½•ã‚³ã‚¤ãƒ³ã®é…å½“ãŒã‚ã‚‹ã‹ã‚’å®šç¾©ã™ã‚‹
		const payoutTable = {
			'ï¼—ï¼—ï¼—': 300,
			'ğŸ‘‘ğŸ‘‘ğŸ‘‘': 100,
			'BARBARBAR': 80,
			'ğŸ””ğŸ””ğŸ””': 50,
			'ğŸ‰ğŸ‰ğŸ‰': 20,
			'ğŸ’ğŸ’ğŸ’': 10,
		};
		

		// --- ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç† ---
		// ã‚²ãƒ¼ãƒ ã®é€²è¡ŒçŠ¶æ³ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®å¤‰æ•°
		let credits = 1000; // æ‰€æŒã‚³ã‚¤ãƒ³
		const spinCost = 10; // 1ã‚¹ãƒ”ãƒ³ã‚ãŸã‚Šã®æ¶ˆè²»ã‚³ã‚¤ãƒ³
		let isSpinning = false; // ç¾åœ¨ã‚¹ãƒ”ãƒ³ä¸­ã‹ã©ã†ã‹ã‚’ç¤ºã™ãƒ•ãƒ©ã‚°

		// --- ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ ---

		/**
		 * ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–å‡¦ç†
		 * ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã¨ãã«æœ€åˆã«å®Ÿè¡Œã•ã‚Œã‚‹
		 */
		function init() {
			updateCreditsDisplay(); // ã‚³ã‚¤ãƒ³è¡¨ç¤ºã‚’æ›´æ–°
			// 3æœ¬ã®ãƒªãƒ¼ãƒ«ã®åˆæœŸè¡¨ç¤ºã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¨­å®š
			reels.forEach((reel, i) => {
				const stopIndex = Math.floor(Math.random() * reel.length);
				updateReelDisplay(i, stopIndex);
			});
		}

		/**
		 * ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã®ãƒ¡ã‚¤ãƒ³å‡¦ç†
		 */
		async function handleSpin() {
			// ã‚¹ãƒ”ãƒ³ä¸­ã€ã¾ãŸã¯ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šãªã„å ´åˆã¯å‡¦ç†ã‚’ä¸­æ–­
			if (isSpinning || credits < spinCost) return;

			// ã‚¹ãƒ”ãƒ³é–‹å§‹ã®æº–å‚™
			isSpinning = true; // ã‚¹ãƒ”ãƒ³ä¸­ã®çŠ¶æ…‹ã«ã™ã‚‹
			spinButton.disabled = true; // ãƒœã‚¿ãƒ³ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–
			resultDisplay.textContent = 'ã‚¹ãƒ”ãƒ³ä¸­...'; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
			clearWinHighlights(); // å‰å›ã®å½“ãŸã‚Šãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’æ¶ˆã™

			// ã‚¹ãƒ”ãƒ³ã®ã‚³ã‚¹ãƒˆã‚’æ”¯æ‰•ã†
			credits -= spinCost;
			updateCreditsDisplay(); // ã‚³ã‚¤ãƒ³è¡¨ç¤ºã‚’æ›´æ–°

			// 3æœ¬ã™ã¹ã¦ã®ãƒªãƒ¼ãƒ«ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹
			reelElements.forEach((reelEl, i) => {
				setupSpinningReel(i); // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒªãƒ¼ãƒ«ã‚’æº–å‚™
				reelEl.classList.add('spinning'); // CSSã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
			});


			// å„ãƒªãƒ¼ãƒ«ã‚’å°‘ã—ãšã¤ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ãšã‚‰ã—ã¦åœæ­¢ã•ã›ã‚‹
			const stopIndexes = []; // å„ãƒªãƒ¼ãƒ«ã®åœæ­¢ä½ç½®ã‚’ä¿å­˜ã™ã‚‹é…åˆ—
			for (let i = 0; i < reels.length; i++) {
				// 0.2ç§’å¾…ã£ã¦ã‹ã‚‰æ¬¡ã®ãƒªãƒ¼ãƒ«ã‚’åœæ­¢ã™ã‚‹
				await new Promise(resolve => setTimeout(resolve, 200));
				// ãƒ©ãƒ³ãƒ€ãƒ ãªä½ç½®ã§ãƒªãƒ¼ãƒ«ã‚’åœæ­¢
				const stopIndex = Math.floor(Math.random() * reels[i].length);
				stopIndexes.push(stopIndex);
				// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åœæ­¢ã—ã€æœ€çµ‚çš„ãªçµæœã‚’è¡¨ç¤º
				reelElements[i].classList.remove('spinning');
				updateReelDisplay(i, stopIndex);
			}

			// å½“ãŸã‚Šåˆ¤å®šã‚’å®Ÿè¡Œ
			checkWin(stopIndexes);

			// ã‚¹ãƒ”ãƒ³çµ‚äº†å¾Œã®å‡¦ç†
			isSpinning = false; // ã‚¹ãƒ”ãƒ³ä¸­ã®çŠ¶æ…‹ã‚’è§£é™¤
			if (credits >= spinCost) {
				spinButton.disabled = false; // ã‚³ã‚¤ãƒ³ãŒã‚ã‚Œã°ãƒœã‚¿ãƒ³ã‚’å†åº¦æœ‰åŠ¹åŒ–
			} else {
				resultDisplay.textContent = 'ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šã¾ã›ã‚“ï¼';
			}
		}

		/**
		 * ã‚¹ãƒ”ãƒ³ä¸­ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«ãƒªãƒ¼ãƒ«ã®è¡¨ç¤ºã‚’æº–å‚™ã™ã‚‹
		 * @param {number} reelIndex - æº–å‚™ã™ã‚‹ãƒªãƒ¼ãƒ«ã®ç•ªå· (0-2)
		 */
		function setupSpinningReel(reelIndex) {
			const reel = reels[reelIndex];
			const reelEl = reelElements[reelIndex];
			reelEl.innerHTML = ''; // ç¾åœ¨ã®è¡¨ç¤ºã‚’ä¸€æ—¦ã‚¯ãƒªã‚¢

			const reelInner = document.createElement('div');
			reelInner.classList.add('reel-inner');

			// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒé€”åˆ‡ã‚Œãªã„ã‚ˆã†ã«ã€çµµæŸ„ã‚’2å‘¨åˆ†ã¤ãªã’ã¦é…ç½®ã™ã‚‹
			const extendedSymbols = [...reel, ...reel];

			// å„çµµæŸ„ã‚’ã‚»ãƒ«ã¨ã—ã¦HTMLã«è¿½åŠ 
			for (const symbol of extendedSymbols) {
				const cell = document.createElement('div');
				cell.classList.add('cell');
				cell.textContent = symbol;
				reelInner.appendChild(cell);
			}
			reelEl.appendChild(reelInner);
		}


		/**
		 * å½“ãŸã‚Šåˆ¤å®šå‡¦ç†
		 * @param {number[]} stopIndexes - 3ã¤ã®ãƒªãƒ¼ãƒ«ã®åœæ­¢ä½ç½®ã®é…åˆ—
		 */
		function checkWin(stopIndexes) {
			const board = getBoard(stopIndexes); // ç¾åœ¨ã®è¡¨ç¤ºç›¤é¢ã‚’å–å¾—
			let totalWin = 0; // åˆè¨ˆç²å¾—ã‚³ã‚¤ãƒ³

			// å½“ãŸã‚Šãƒ©ã‚¤ãƒ³ã®å®šç¾©ï¼ˆä¸Šæ®µã€ä¸­æ®µã€ä¸‹æ®µã€å³ä¸‹ãŒã‚Šã€å³ä¸ŠãŒã‚Šï¼‰
			const paylines = [
				[0, 0, 0], // ä¸Šæ®µ
				[1, 1, 1], // ä¸­æ®µ
				[2, 2, 2], // ä¸‹æ®µ
				[0, 1, 2], // å³ä¸‹ãŒã‚Šæ–œã‚
				[2, 1, 0] // å³ä¸ŠãŒã‚Šæ–œã‚
			];

			const winningLines = []; // å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã®æƒ…å ±ã‚’ä¿å­˜
			let hasThreeOfAKind = false; // ãƒã‚§ãƒªãƒ¼ä»¥å¤–ã®3ã¤æƒã„ãŒã‚ã£ãŸã‹

			// 5ã¤ã®å½“ãŸã‚Šãƒ©ã‚¤ãƒ³ã‚’é †ç•ªã«ãƒã‚§ãƒƒã‚¯
			paylines.forEach((line, lineIndex) => {
				const symbol1 = board[0][line[0]];
				const symbol2 = board[1][line[1]];
				const symbol3 = board[2][line[2]];

				// 3ã¤ã®çµµæŸ„ãŒã™ã¹ã¦åŒã˜å ´åˆ
				if (symbol1 === symbol2 && symbol2 === symbol3) {
					const winKey = `${symbol1}${symbol2}${symbol3}`;
					// é…å½“è¡¨ã«ãã®çµµæŸ„ã®çµ„ã¿åˆã‚ã›ãŒã‚ã‚Œã°ã€å½“ãŸã‚Šã¨ã™ã‚‹
					if (payoutTable[winKey]) {
						totalWin += payoutTable[winKey];
						winningLines.push(lineIndex);
						// ãƒã‚§ãƒªãƒ¼ä»¥å¤–ã®3ã¤æƒã„ãŒã‚ã£ãŸã“ã¨ã‚’è¨˜éŒ²
						if (symbol1 !== 'ğŸ’') {
							hasThreeOfAKind = true;
						}
					}
				}
			});

			// ãƒã‚§ãƒªãƒ¼ã®ç‰¹åˆ¥ãƒ«ãƒ¼ãƒ«åˆ¤å®šï¼ˆãƒã‚§ãƒªãƒ¼ä»¥å¤–ã®3ã¤æƒã„ãŒãªã‹ã£ãŸå ´åˆã®ã¿ï¼‰
			if (!hasThreeOfAKind) {
				const cherryLine = [board[0][1], board[1][1], board[2][1]]; // ä¸­æ®µãƒ©ã‚¤ãƒ³ã®ã¿ã§åˆ¤å®š
				const cherryCount = cherryLine.filter(s => s === 'ğŸ’').length;

				// ä»–ã«å½“ãŸã‚ŠãŒãªãã€ãƒã‚§ãƒªãƒ¼ãŒ2ã¤æƒã£ãŸå ´åˆ
				if (totalWin === 0) {
					if (cherryCount === 2) {
						totalWin += cherryPayout.count2;
						if (!winningLines.includes(1)) winningLines.push(1);
					} else if (cherryLine[0] === 'ğŸ’' && cherryLine[1] !== 'ğŸ’' && cherryLine[2] !== 'ğŸ’') { // å·¦ç«¯ã«ãƒã‚§ãƒªãƒ¼ãŒ1ã¤ã ã‘ã®å ´åˆ
						totalWin += cherryPayout.count1;
						if (!winningLines.includes(1)) winningLines.push(1);
					}
				}
			}


			// æœ€çµ‚çš„ãªçµæœã®è¡¨ç¤ºã¨ã‚³ã‚¤ãƒ³ã®æ›´æ–°
			if (totalWin > 0) {
				credits += totalWin;
				resultDisplay.textContent = `${totalWin}ã‚³ã‚¤ãƒ³ GET!`;
				highlightWinningLines(winningLines); // å½“ãŸã‚Šãƒ©ã‚¤ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
			} else {
				resultDisplay.textContent = 'æ®‹å¿µï¼';
			}
			updateCreditsDisplay(); // ã‚³ã‚¤ãƒ³è¡¨ç¤ºã‚’æ›´æ–°
		}

		/**
		 * ç¾åœ¨ã®è¡¨ç¤ºç›¤é¢ã‚’3x3ã®2æ¬¡å…ƒé…åˆ—ã§å–å¾—ã™ã‚‹
		 * @param {number[]} stopIndexes - 3ã¤ã®ãƒªãƒ¼ãƒ«ã®åœæ­¢ä½ç½®ã®é…åˆ—
		 * @returns {string[][]} 3x3ã®ç›¤é¢ãƒ‡ãƒ¼ã‚¿ (ä¾‹: [['ğŸ’','ğŸ””','ğŸ‰'], ['ğŸ’','ğŸ””','ğŸ‰'], ['ğŸ’','ğŸ””','ğŸ‰']])
		 */
		function getBoard(stopIndexes) {
			return stopIndexes.map((stopIndex, reelIndex) => {
				const reel = reels[reelIndex];
				const reelLength = reel.length;
				// åœæ­¢ä½ç½®ã®å‰å¾Œã®çµµæŸ„ã‚’å–å¾—ã—ã¦ã€[ä¸Šæ®µ, ä¸­æ®µ, ä¸‹æ®µ] ã®é…åˆ—ã‚’ä½œæˆ
				const top = reel[(stopIndex - 1 + reelLength) % reelLength];
				const middle = reel[stopIndex];
				const bottom = reel[(stopIndex + 1) % reelLength];
				return [top, middle, bottom];
			});
		}

		/**
		 * ãƒªãƒ¼ãƒ«ã®è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ï¼ˆã‚¹ãƒ”ãƒ³åœæ­¢æ™‚ã«ä½¿ç”¨ï¼‰
		 * @param {number} reelIndex - æ›´æ–°ã™ã‚‹ãƒªãƒ¼ãƒ«ã®ç•ªå· (0-2)
		 * @param {number} stopIndex - åœæ­¢ã™ã‚‹çµµæŸ„ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
		 */
		function updateReelDisplay(reelIndex, stopIndex) {
			const reel = reels[reelIndex];
			const reelLength = reel.length;
			const reelEl = reelElements[reelIndex];

			reelEl.innerHTML = ''; // ç¾åœ¨ã®è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢

			const reelInner = document.createElement('div');
			reelInner.classList.add('reel-inner');

			// åœæ­¢ä½ç½®ã¨ãã®å‰å¾Œã®çµµæŸ„ã®ã¿ã‚’è¡¨ç¤ºã™ã‚‹
			const symbolsToShow = [
				reel[(stopIndex - 1 + reelLength) % reelLength],
				reel[stopIndex],
				reel[(stopIndex + 1) % reelLength],
			];

			for (const symbol of symbolsToShow) {
				const cell = document.createElement('div');
				cell.classList.add('cell');
				cell.textContent = symbol;
				reelInner.appendChild(cell);
			}
			reelEl.appendChild(reelInner);
		}

		/**
		 * æ‰€æŒã‚³ã‚¤ãƒ³ã®è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹
		 */
		function updateCreditsDisplay() {
			creditsDisplay.textContent = `ã‚³ã‚¤ãƒ³: ${credits}`;
		}

		/**
		 * å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹
		 * @param {number[]} lineIndexes - å½“ãŸã£ãŸãƒšã‚¤ãƒ©ã‚¤ãƒ³ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®é…åˆ—
		 */
		function highlightWinningLines(lineIndexes) {
			const paylines = [
				[0, 0, 0], // ä¸Šæ®µ
				[1, 1, 1], // ä¸­æ®µ
				[2, 2, 2], // ä¸‹æ®µ
				[0, 1, 2], // å³ä¸‹ãŒã‚Šæ–œã‚
				[2, 1, 0]  // å³ä¸ŠãŒã‚Šæ–œã‚
			];

			// å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã«å«ã¾ã‚Œã‚‹ã™ã¹ã¦ã®ã‚»ãƒ«ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆç”¨ã®CSSã‚¯ãƒ©ã‚¹ã‚’ä»˜ä¸
			lineIndexes.forEach(lineIndex => {
				const line = paylines[lineIndex];
				line.forEach((cellRowIndex, reelIndex) => {
					const reelEl = reelElements[reelIndex];
					const cell = reelEl.querySelector(`.reel-inner .cell:nth-child(${cellRowIndex + 1})`);
					if (cell) {
						cell.classList.add('winning-cell');
					}
				});
			});
		}


		/**
		 * å…¨ã¦ã®å½“ãŸã‚Šãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’æ¶ˆã™
		 */
		function clearWinHighlights() {
			document.querySelectorAll('.winning-cell').forEach(el => {
				el.classList.remove('winning-cell');
			});
		}


		// --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
		// ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰ã€handleSpiné–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹
		spinButton.addEventListener('click', handleSpin);

		// --- ã‚²ãƒ¼ãƒ é–‹å§‹ ---
		// ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ãŸã‚‰ã€ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã™ã‚‹
		init();
	</script>
</body>

</html>