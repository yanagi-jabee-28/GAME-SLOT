<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>çµµæ–‡å­—ã‚¹ãƒ­ãƒƒãƒˆã‚²ãƒ¼ãƒ </title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700;900&display=swap" rel="stylesheet">
	<style>
		/* å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
		body {
			font-family: 'M PLUS Rounded 1c', sans-serif;
			background-color: #1a2a3a;
			color: #ffffff;
			display: flex;
			justify-content: center;
			align-items: center;
			min-height: 100vh;
			margin: 0;
			user-select: none;
		}

		/* ã‚²ãƒ¼ãƒ å…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ */
		#game-container {
			background: linear-gradient(45deg, #3a4a5a, #2a3a4a);
			border-radius: 20px;
			padding: 20px 30px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4), inset 0 2px 5px rgba(255, 255, 255, 0.1);
			border: 2px solid #5a6a7a;
			text-align: center;
			width: 90%;
			max-width: 400px;
		}

		/* ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ† */
		header h1 {
			font-size: 2.5rem;
			font-weight: 900;
			color: #ffc107;
			text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
			margin: 0 0 10px 0;
		}

		/* ã‚³ã‚¤ãƒ³è¡¨ç¤º */
		#credits-display {
			background-color: #111;
			color: #00ff00;
			font-size: 1.5rem;
			padding: 10px;
			border-radius: 10px;
			margin-bottom: 20px;
			border: 2px solid #444;
			box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
		}

		/* ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³æœ¬ä½“ */
		#slot-machine {
			display: flex;
			justify-content: center;
			gap: 10px;
			background-color: #000;
			padding: 15px;
			border-radius: 15px;
			border: 5px solid #888;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
			margin-bottom: 20px;
		}

		/* å„ãƒªãƒ¼ãƒ« */
		.reel {
			background-color: #fff;
			border: 2px solid #333;
			border-radius: 10px;
			overflow: hidden;
			width: 80px;
			height: 240px;
			/* 80px * 3ã‚»ãƒ«åˆ† */
			position: relative;
		}

		.reel-inner {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
		}

		/* å„ãƒã‚¹ */
		.cell {
			width: 80px;
			height: 80px;
			font-size: 50px;
			display: flex;
			justify-content: center;
			align-items: center;
			background-color: #fff;
			color: #333;
			border-bottom: 1px solid #ccc;
		}

		.cell:last-child {
			border-bottom: none;
		}

		/* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
		#result-display {
			height: 50px;
			font-size: 1.2rem;
			font-weight: bold;
			color: #ffeb3b;
			display: flex;
			justify-content: center;
			align-items: center;
			transition: all 0.3s ease;
		}

		/* ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ */
		#spin-button {
			background: linear-gradient(180deg, #f44336, #d32f2f);
			color: white;
			font-size: 1.8rem;
			font-weight: 700;
			padding: 15px 40px;
			border: none;
			border-radius: 50px;
			cursor: pointer;
			box-shadow: 0 5px 0 #9a0007, 0 8px 15px rgba(0, 0, 0, 0.4);
			transition: all 0.1s ease-in-out;
		}

		#spin-button:disabled {
			background: #777;
			box-shadow: 0 5px 0 #444;
			cursor: not-allowed;
		}

		#spin-button:not(:disabled):active {
			transform: translateY(5px);
			box-shadow: 0 0px 0 #9a0007;
		}

		/* ã‚¹ãƒ”ãƒ³ä¸­ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
		.spinning .reel-inner {
			animation: scroll-reel 0.2s linear infinite;
		}

		@keyframes scroll-reel {
			from {
				transform: translateY(-50%);
			}

			to {
				transform: translateY(0);
			}
		}

		/* å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
		.winning-cell {
			animation: win-pulse 0.8s infinite;
		}

		@keyframes win-pulse {
			0% {
				transform: scale(1);
				background-color: #fff2ab;
			}

			50% {
				transform: scale(1.1);
				background-color: #ffc107;
			}

			100% {
				transform: scale(1);
				background-color: #fff2ab;
			}
		}
	</style>
</head>

<body>

	<div id="game-container">
		<header>
			<h1>çµµæ–‡å­—ã‚¹ãƒ­ãƒƒãƒˆ</h1>
			<div id="credits-display">ã‚³ã‚¤ãƒ³: 1000</div>
		</header>

		<main>
			<div id="slot-machine">
				<div class="reel" id="reel1"></div>
				<div class="reel" id="reel2"></div>
				<div class="reel" id="reel3"></div>
			</div>

			<div id="result-display">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆï¼</div>
			<button id="spin-button">ã‚¹ãƒ”ãƒ³ï¼</button>
		</main>
	</div>

	<script>
		// --- DOMè¦ç´ ã®å–å¾— ---
		const reelElements = [
			document.getElementById('reel1'),
			document.getElementById('reel2'),
			document.getElementById('reel3')
		];
		const spinButton = document.getElementById('spin-button');
		const creditsDisplay = document.getElementById('credits-display');
		const resultDisplay = document.getElementById('result-display');

		// --- ã‚²ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š ---

		// å„ãƒªãƒ¼ãƒ«ã®çµµæŸ„ã®ä¸¦ã³é †ï¼ˆãƒªãƒ¼ãƒ«ã‚¹ãƒˆãƒªãƒƒãƒ—ï¼‰
		// ãƒ–ãƒ©ãƒ³ã‚¯çµµæŸ„ã‚’ãªãã—ã€å½“ãŸã‚ŠãŒå‡ºã‚„ã™ã„ã‚ˆã†ã«èª¿æ•´ã€‚
		// ã¾ãŸã€ãƒªãƒ¼ãƒ«ã®ä¸¦ã³ã¯ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã›ãšã€å½“ãŸã‚ŠãŒå‡ºã‚„ã™ã„ã‚ˆã†ã«ã—ã¤ã¤ã‚‚ã€
		// é«˜é…å½“ã®çµµæŸ„ãŒé€£ç¶šã—ãªã„ã‚ˆã†ã«æ‰‹å‹•ã§æœ€é©ãªä¸¦ã³é †ã«èª¿æ•´ã—ã¦ã„ã‚‹ã€‚
		const reel1 = [
			'ğŸ’', 'ğŸ‰', 'ğŸ””', 'BAR', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'BAR', 'ğŸ‰', 'ğŸ’', 'ï¼—', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'BAR', 'ğŸ‘‘', 'ğŸ””', 'ğŸ’', 'ğŸ‰'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reel2 = [
			'BAR', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'BAR', 'ğŸ””', 'ğŸ’', 'ï¼—', 'ğŸ‰', 'ğŸ’', 'ğŸ””', 'BAR', 'ğŸ‘‘', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ğŸ‰'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reel3 = [
			'ğŸ‘‘', 'BAR', 'ğŸ’', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ï¼—', 'ğŸ‰', 'BAR', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'ğŸ‘‘', 'ğŸ””', 'ğŸ’', 'BAR', 'ğŸ‰', 'ğŸ””', 'ğŸ’', 'ğŸ‰', 'ğŸ’'
		]; // åˆè¨ˆ21ãƒã‚¹
		const reels = [reel1, reel2, reel3];

		// é…å½“è¡¨ (ã‚­ãƒ¼ã¯æƒã£ãŸçµµæ–‡å­—ã‚’é€£çµã—ãŸæ–‡å­—åˆ—)
		const payoutTable = {
			'ï¼—ï¼—ï¼—': 300,
			'ğŸ‘‘ğŸ‘‘ğŸ‘‘': 100,
			'BARBARBAR': 80, // BARã®å½¹ã‚’è¿½åŠ 
			'ğŸ””ğŸ””ğŸ””': 50,
			'ğŸ‰ğŸ‰ğŸ‰': 20,
			'ğŸ’ğŸ’ğŸ’': 10,
		};
		// ãƒã‚§ãƒªãƒ¼ã¯2ã¤ã§ã‚‚å½“ãŸã‚Š
		const cherryPayout = {
			count2: 5,
			count1: 2, // æœ€åˆã®1ãƒªãƒ¼ãƒ«ç›®ã®ã¿
		};

		// ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹
		let credits = 1000;
		const spinCost = 10;
		let isSpinning = false;

		// --- ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ ---

		/**
		 * åˆæœŸåŒ–å‡¦ç†
		 */
		function init() {
			updateCreditsDisplay();
			// åˆæœŸç›¤é¢ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¨­å®š
			reels.forEach((reel, i) => {
				const stopIndex = Math.floor(Math.random() * reel.length);
				updateReelDisplay(i, stopIndex);
			});
		}

		/**
		 * ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã®å‡¦ç†
		 */
		async function handleSpin() {
			if (isSpinning || credits < spinCost) return;

			isSpinning = true;
			spinButton.disabled = true;
			resultDisplay.textContent = 'ã‚¹ãƒ”ãƒ³ä¸­...';
			clearWinHighlights();

			// ã‚³ã‚¤ãƒ³ã‚’æ¶ˆè²»
			credits -= spinCost;
			updateCreditsDisplay();

			// ã‚¹ãƒ”ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
			reelElements.forEach((reelEl, i) => {
				setupSpinningReel(i);
				reelEl.classList.add('spinning');
			});


			// å„ãƒªãƒ¼ãƒ«ã‚’å°‘ã—ãšã¤ãšã‚‰ã—ã¦åœæ­¢ã•ã›ã‚‹
			const stopIndexes = [];
			for (let i = 0; i < reels.length; i++) {
				await new Promise(resolve => setTimeout(resolve, 200)); // åœæ­¢ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ãšã‚‰ã—ã€æ™‚é–“ã‚’çŸ­ç¸®
				const stopIndex = Math.floor(Math.random() * reels[i].length);
				stopIndexes.push(stopIndex);
				reelElements[i].classList.remove('spinning');
				updateReelDisplay(i, stopIndex);
			}

			// å½“ãŸã‚Šåˆ¤å®š
			checkWin(stopIndexes);

			isSpinning = false;
			if (credits >= spinCost) {
				spinButton.disabled = false;
			} else {
				resultDisplay.textContent = 'ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šã¾ã›ã‚“ï¼';
			}
		}

		/**
		 * ã‚¹ãƒ”ãƒ³ä¸­ã®ãƒªãƒ¼ãƒ«ã‚’æº–å‚™ã™ã‚‹
		 * @param {number} reelIndex
		 */
		function setupSpinningReel(reelIndex) {
			const reel = reels[reelIndex];
			const reelEl = reelElements[reelIndex];
			reelEl.innerHTML = ''; // ä¸­èº«ã‚’ã‚¯ãƒªã‚¢

			const reelInner = document.createElement('div');
			reelInner.classList.add('reel-inner');

			// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒé€”åˆ‡ã‚Œãªã„ã‚ˆã†ã«ã€çµµæŸ„ã‚’2å‘¨åˆ†ç”¨æ„ã™ã‚‹
			const extendedSymbols = [...reel, ...reel];

			for (const symbol of extendedSymbols) {
				const cell = document.createElement('div');
				cell.classList.add('cell');
				cell.textContent = symbol;
				reelInner.appendChild(cell);
			}
			reelEl.appendChild(reelInner);
		}


		/**
		 * å½“ãŸã‚Šåˆ¤å®šå‡¦ç†
		 * @param {number[]} stopIndexes - 3ã¤ã®ãƒªãƒ¼ãƒ«ã®åœæ­¢ä½ç½®
		 */
		function checkWin(stopIndexes) {
			const board = getBoard(stopIndexes);
			let totalWin = 0;

			// å½“ãŸã‚Šãƒ©ã‚¤ãƒ³ã®å®šç¾© [ [ãƒªãƒ¼ãƒ«0ã®è¡Œ, ãƒªãƒ¼ãƒ«1ã®è¡Œ, ãƒªãƒ¼ãƒ«2ã®è¡Œ], ... ]
			const paylines = [
				[0, 0, 0], // ä¸Šæ®µ
				[1, 1, 1], // ä¸­æ®µ
				[2, 2, 2], // ä¸‹æ®µ
				[0, 1, 2], // å³ä¸‹ãŒã‚Šæ–œã‚
				[2, 1, 0] // å³ä¸ŠãŒã‚Šæ–œã‚
			];

			const winningLines = [];
			let hasThreeOfAKind = false;

			// 5ãƒ©ã‚¤ãƒ³ã®å½“ãŸã‚Šåˆ¤å®š
			paylines.forEach((line, lineIndex) => {
				const symbol1 = board[0][line[0]];
				const symbol2 = board[1][line[1]];
				const symbol3 = board[2][line[2]];

				if (symbol1 === symbol2 && symbol2 === symbol3) {
					const winKey = `${symbol1}${symbol2}${symbol3}`;
					if (payoutTable[winKey]) {
						totalWin += payoutTable[winKey];
						winningLines.push(lineIndex);
						if (symbol1 !== 'ğŸ’') { // ãƒã‚§ãƒªãƒ¼ä»¥å¤–ã®3ã¤æƒã„ã¯ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
							hasThreeOfAKind = true;
						}
					}
				}
			});

			// ãƒã‚§ãƒªãƒ¼ã®ç‰¹åˆ¥åˆ¤å®š (3ã¤æƒã„ã®å½¹ãŒãªã‹ã£ãŸå ´åˆã®ã¿)
			if (!hasThreeOfAKind) {
				const cherryLine = [board[0][1], board[1][1], board[2][1]]; // ä¸­æ®µãƒ©ã‚¤ãƒ³ã®ã¿ã§åˆ¤å®š
				const cherryCount = cherryLine.filter(s => s === 'ğŸ’').length;

				if (totalWin === 0) { // 3ã¤æƒã„ã®å½¹ãŒãªã‹ã£ãŸå ´åˆ
					if (cherryCount === 2) {
						totalWin += cherryPayout.count2;
						if (!winningLines.includes(1)) winningLines.push(1);
					} else if (cherryLine[0] === 'ğŸ’' && cherryLine[1] !== 'ğŸ’' && cherryLine[2] !== 'ğŸ’') { // 1ãƒªãƒ¼ãƒ«ç›®ä¸­æ®µã®ã¿ãƒã‚§ãƒªãƒ¼
						totalWin += cherryPayout.count1;
						if (!winningLines.includes(1)) winningLines.push(1);
					}
				}
			}


			// çµæœã®è¡¨ç¤ºã¨ã‚³ã‚¤ãƒ³ã®æ›´æ–°
			if (totalWin > 0) {
				credits += totalWin;
				resultDisplay.textContent = `${totalWin}ã‚³ã‚¤ãƒ³ GET!`;
				highlightWinningLines(winningLines);
			} else {
				resultDisplay.textContent = 'æ®‹å¿µï¼';
			}
			updateCreditsDisplay();
		}

		/**
		 * ç¾åœ¨ã®ç›¤é¢ã‚’2æ¬¡å…ƒé…åˆ—ã§å–å¾—
		 * @param {number[]} stopIndexes - 3ã¤ã®ãƒªãƒ¼ãƒ«ã®åœæ­¢ä½ç½®
		 * @returns {string[][]} 3x3ã®ç›¤é¢ãƒ‡ãƒ¼ã‚¿
		 */
		function getBoard(stopIndexes) {
			return stopIndexes.map((stopIndex, reelIndex) => {
				const reel = reels[reelIndex];
				const reelLength = reel.length;
				const top = reel[(stopIndex - 1 + reelLength) % reelLength];
				const middle = reel[stopIndex];
				const bottom = reel[(stopIndex + 1) % reelLength];
				return [top, middle, bottom];
			});
		}

		/**
		 * ãƒªãƒ¼ãƒ«ã®è¡¨ç¤ºã‚’æ›´æ–°ï¼ˆåœæ­¢æ™‚ï¼‰
		 * @param {number} reelIndex - æ›´æ–°ã™ã‚‹ãƒªãƒ¼ãƒ«ã®ç•ªå· (0-2)
		 * @param {number} stopIndex - åœæ­¢ã™ã‚‹çµµæŸ„ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
		 */
		function updateReelDisplay(reelIndex, stopIndex) {
			const reel = reels[reelIndex];
			const reelLength = reel.length;
			const reelEl = reelElements[reelIndex];

			reelEl.innerHTML = ''; // ä¸­èº«ã‚’ã‚¯ãƒªã‚¢

			const reelInner = document.createElement('div');
			reelInner.classList.add('reel-inner');

			const symbolsToShow = [
				reel[(stopIndex - 1 + reelLength) % reelLength],
				reel[stopIndex],
				reel[(stopIndex + 1) % reelLength],
			];

			for (const symbol of symbolsToShow) {
				const cell = document.createElement('div');
				cell.classList.add('cell');
				cell.textContent = symbol;
				reelInner.appendChild(cell);
			}
			reelEl.appendChild(reelInner);
		}

		/**
		 * ã‚³ã‚¤ãƒ³è¡¨ç¤ºã‚’æ›´æ–°
		 */
		function updateCreditsDisplay() {
			creditsDisplay.textContent = `ã‚³ã‚¤ãƒ³: ${credits}`;
		}

		/**
		 * å½“ãŸã£ãŸãƒ©ã‚¤ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹
		 * @param {number[]} lineIndexes - å½“ãŸã£ãŸãƒšã‚¤ãƒ©ã‚¤ãƒ³ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®é…åˆ—
		 */
		function highlightWinningLines(lineIndexes) {
			const paylines = [
				[0, 0, 0], // ä¸Šæ®µ
				[1, 1, 1], // ä¸­æ®µ
				[2, 2, 2], // ä¸‹æ®µ
				[0, 1, 2], // å³ä¸‹ãŒã‚Šæ–œã‚
				[2, 1, 0]  // å³ä¸ŠãŒã‚Šæ–œã‚
			];

			lineIndexes.forEach(lineIndex => {
				const line = paylines[lineIndex];
				line.forEach((cellRowIndex, reelIndex) => {
					const reelEl = reelElements[reelIndex];
					const cell = reelEl.querySelector(`.reel-inner .cell:nth-child(${cellRowIndex + 1})`);
					if (cell) {
						cell.classList.add('winning-cell');
					}
				});
			});
		}


		/**
		 * å…¨ã¦ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’æ¶ˆã™
		 */
		function clearWinHighlights() {
			document.querySelectorAll('.winning-cell').forEach(el => {
				el.classList.remove('winning-cell');
			});
		}


		// --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
		spinButton.addEventListener('click', handleSpin);

		// --- ã‚²ãƒ¼ãƒ é–‹å§‹ ---
		init();
	</script>
</body>

</html>